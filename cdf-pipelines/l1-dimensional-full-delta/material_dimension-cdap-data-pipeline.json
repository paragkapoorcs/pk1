{
    "name": "material_dimension",
    "description": "material dimension",
    "artifact": {
        "name": "cdap-data-pipeline",
        "version": "6.4.0",
        "scope": "SYSTEM"
    },
    "config": {
        "resources": {
            "memoryMB": 2048,
            "virtualCores": 1
        },
        "driverResources": {
            "memoryMB": 2048,
            "virtualCores": 1
        },
        "connections": [
            {
                "from": "Merge Statement",
                "to": "Update Audit Table"
            }
        ],
        "comments": [],
        "postActions": [],
        "properties": {},
        "processTimingEnabled": true,
        "stageLoggingEnabled": false,
        "stages": [
            {
                "name": "Merge Statement",
                "plugin": {
                    "name": "BigQueryExecute",
                    "type": "action",
                    "label": "Merge Statement",
                    "artifact": {
                        "name": "google-cloud",
                        "version": "0.17.0",
                        "scope": "SYSTEM"
                    },
                    "properties": {
                        "project": "auto-detect",
                        "sql": "MERGE INTO `${ProjectID}.${TargetDatasetName}.material_dimension` tgt\nUSING \n(SELECT\n  mm.material_group as material_group_join_key,\n  mm.material_number as material_number_join_key,\n  mm.industry_sector as industry_sector_join_key,\n  mm.material_type as material_type_join_key,\n  mm.material_group,\n  mm.material_number,\n  mm.industry_sector,\n  mm.material_type,\n  mm.created_on,\n  mm.created_by,\n  mm.last_change,\n  mm.changed_by,\n  mm.complete_material_status,\n  mm.maintenance_status,\n  mm.client_level_deletion_flag,\n  mm.old_material_number,\n  mm.base_unit_of_measure,\n  mm.purchase_order_unit,\n  mm.document_number,\n  mm.document_type,\n  mm.document_version,\n  mm.page_format_2,\n  mm.document_change_number,\n  mm.page_number,\n  mm.number_of_sheets,\n  mm.production_memo,\n  mm.page_format_1,\n  mm.size_dimensions,\n  mm.basic_material,\n  mm.industry_standard_description,\n  mm.laboratory_design_office,\n  mm.purchasing_value_key,\n  mm.gross_weight,\n  mm.net_weight,\n  mm.weight_unit,\n  mm.volume,\n  mm.volume_unit_2,\n  mm.container_requirements,\n  mm.storage_conditions,\n  mm.temperature_conditions_indicator,\n  mm.low_level_code,\n  mm.transportation_group,\n  mm.hazardous_material_number,\n  mm.division,\n  mm.customer_number,\n  mm.european_article_number,\n  mm.goods_receipt_slips_quantity,\n  mm.procurement_rule,\n  mm.source_of_supply,\n  mm.season_category,\n  mm.label_type,\n  mm.label_form,\n  mm.disposal_type,\n  mm.international_article_number,\n  mm.ean_category,\n  mm.length,\n  mm.width,\n  mm.height,\n  mm.unit_of_dimension,\n  mm.product_hierarchy,\n  mm.net_change_costing,\n  mm.cad_indicator,\n  mm.qm_procurement,\n  mm.allowed_packaging_weight,\n  mm.unit_of_weight,\n  mm.allowed_packaging_volume,\n  mm.volume_unit_1,\n  mm.excess_weight_tolerance,\n  mm.excess_volume_tolerance,\n  mm.variable_purchase_order_unit_active,\n  mm.revision_level_assigned,\n  mm.configurable_material,\n  mm.batch_management_requirement,\n  mm.packaging_material_type,\n  mm.maximum_level,\n  mm.stacking_factor,\n  mm.material_group_packaging_materials,\n  mm.authorization_group,\n  mm.valid_from,\n  mm.deletion_date,\n  mm.season_year,\n  mm.price_band_category,\n  mm.empties_bill_of_material,\n  mm.external_material_group,\n  mm.cross_plant_configurable_material,\n  mm.material_category,\n  mm.material_co_product,\n  mm.follow_up_material,\n  mm.pricing_reference_material,\n  mm.cross_plant_material_status,\n  mm.cross_distribution_chain_status,\n  mm.cross_plant_valid_from,\n  mm.cross_distribution_valid_from,\n  mm.tax_classification,\n  mm.catalog_profile,\n  mm.minimum_remaining_shelf_life,\n  mm.total_shelf_life,\n  mm.storage_percentage,\n  mm.content_unit,\n  mm.net_contents,\n  mm.comparison_price_unit,\n  mm.labeling_material_grouping,\n  mm.gross_contents,\n  mm.quantity_conversion_method,\n  mm.internal_object_number,\n  mm.environmentally_relevant,\n  mm.product_allocation,\n  mm.pricing_profile,\n  mm.discount_in_kind,\n  mm.manufacturer_part_number,\n  mm.manufacturer_number,\n  mm.inventory_material_number,\n  mm.manufacturer_part_profile,\n  mm.units_of_measure_usage,\n  mm.rollout_season,\n  mm.dangerous_goods_indicator_profile,\n  mm.highly_viscous,\n  mm.in_bulk_liquid,\n  mm.serialization_level,\n  mm.closed,\n  mm.approved_batch_record_required,\n  mm.assign_effectivity_values,\n  mm.material_completion_level,\n  mm.shelf_life_expiration_date,\n  mm.rounding_rule_sled,\n  mm.product_composition,\n  mm.general_category_group,\n  mm.logistical_variants,\n  mm.cw_material,\n  mm.valuation_unit_of_measure,\n  mm.cw_tolerance_group,\n  mm.checkbox,\n  mm.base_unit_of_measure_1,\n  mm.nato_stock_number,\n  mm.internal_charactieristic_number,\n  mm.internal_char_number_main,\n  mm.internal_char_number_second,\n  mm.colors_of_variants,\n  mm.main_size,\n  mm.second_size,\n  mm.free_characteristic_value,\n  mm.care_code,\n  mm.brand,\n  mm.fiber_code_component_1,\n  mm.percentage_share_1,\n  mm.fiber_code_component_2,\n  mm.percentage_share_2,\n  mm.fiber_code_component_3,\n  mm.percentage_share_3,\n  mm.fiber_code_component_4,\n  mm.percentage_share_4,\n  mm.material_group_hierarchy_level_1,\n  mm.material_group_hierarchy_level_2,\n  mm.material_group_hierarchy_level_3,\n  mm.material_group_hierarchy_level_4,\n  mm.fashion_grade,\n  md.language_key,\n  md.material_description,\n  CASE WHEN mm.dw_last_update_date > md.dw_last_update_date \n       THEN mm.dw_last_update_date\n       ELSE md.dw_last_update_date\n  END AS input_last_update_date,\n  mm.dw_active_indicator\nFROM `${ProjectID}.${StagingDatasetName}.material_master` mm\n     INNER JOIN `${ProjectID}.${StagingDatasetName}.material_description` md\n  ON md.material_number = mm.material_number\n AND md.dw_active_indicator = mm.dw_active_indicator\n AND md.language_key IN ('E','EN')\n     INNER JOIN `${ProjectID}.${StagingDatasetName}.layer1_audit_table` lat\n  ON 1 = 1\n AND lat.table_name = 'material_dimension'\nWHERE mm.dw_active_indicator = 'Y'\n  AND (mm.dw_last_update_date >= CASE WHEN lat.full_delta_indicator = 'F' THEN lat.full_load_datetime\n                                        WHEN lat.full_delta_indicator <> 'F' THEN lat.delta_load_datetime\n                                        ELSE CAST('1900-01-01T00:00:00' AS DATETIME)\n                                   END\n    OR md.dw_last_update_date >= CASE WHEN lat.full_delta_indicator = 'F' THEN lat.full_load_datetime\n                                        WHEN lat.full_delta_indicator <> 'F' THEN lat.delta_load_datetime\n                                        ELSE CAST('1900-01-01T00:00:00' AS DATETIME)\n                                   END)\nUNION ALL \nSELECT\n  NULL as material_group_join_key,\n  NULL as material_number_join_key,\n  NULL as industry_sector_join_key,\n  NULL as material_type_join_key,\n  mm.material_group,\n  mm.material_number,\n  mm.industry_sector,\n  mm.material_type,\n  mm.created_on,\n  mm.created_by,\n  mm.last_change,\n  mm.changed_by,\n  mm.complete_material_status,\n  mm.maintenance_status,\n  mm.client_level_deletion_flag,\n  mm.old_material_number,\n  mm.base_unit_of_measure,\n  mm.purchase_order_unit,\n  mm.document_number,\n  mm.document_type,\n  mm.document_version,\n  mm.page_format_2,\n  mm.document_change_number,\n  mm.page_number,\n  mm.number_of_sheets,\n  mm.production_memo,\n  mm.page_format_1,\n  mm.size_dimensions,\n  mm.basic_material,\n  mm.industry_standard_description,\n  mm.laboratory_design_office,\n  mm.purchasing_value_key,\n  mm.gross_weight,\n  mm.net_weight,\n  mm.weight_unit,\n  mm.volume,\n  mm.volume_unit_2,\n  mm.container_requirements,\n  mm.storage_conditions,\n  mm.temperature_conditions_indicator,\n  mm.low_level_code,\n  mm.transportation_group,\n  mm.hazardous_material_number,\n  mm.division,\n  mm.customer_number,\n  mm.european_article_number,\n  mm.goods_receipt_slips_quantity,\n  mm.procurement_rule,\n  mm.source_of_supply,\n  mm.season_category,\n  mm.label_type,\n  mm.label_form,\n  mm.disposal_type,\n  mm.international_article_number,\n  mm.ean_category,\n  mm.length,\n  mm.width,\n  mm.height,\n  mm.unit_of_dimension,\n  mm.product_hierarchy,\n  mm.net_change_costing,\n  mm.cad_indicator,\n  mm.qm_procurement,\n  mm.allowed_packaging_weight,\n  mm.unit_of_weight,\n  mm.allowed_packaging_volume,\n  mm.volume_unit_1,\n  mm.excess_weight_tolerance,\n  mm.excess_volume_tolerance,\n  mm.variable_purchase_order_unit_active,\n  mm.revision_level_assigned,\n  mm.configurable_material,\n  mm.batch_management_requirement,\n  mm.packaging_material_type,\n  mm.maximum_level,\n  mm.stacking_factor,\n  mm.material_group_packaging_materials,\n  mm.authorization_group,\n  mm.valid_from,\n  mm.deletion_date,\n  mm.season_year,\n  mm.price_band_category,\n  mm.empties_bill_of_material,\n  mm.external_material_group,\n  mm.cross_plant_configurable_material,\n  mm.material_category,\n  mm.material_co_product,\n  mm.follow_up_material,\n  mm.pricing_reference_material,\n  mm.cross_plant_material_status,\n  mm.cross_distribution_chain_status,\n  mm.cross_plant_valid_from,\n  mm.cross_distribution_valid_from,\n  mm.tax_classification,\n  mm.catalog_profile,\n  mm.minimum_remaining_shelf_life,\n  mm.total_shelf_life,\n  mm.storage_percentage,\n  mm.content_unit,\n  mm.net_contents,\n  mm.comparison_price_unit,\n  mm.labeling_material_grouping,\n  mm.gross_contents,\n  mm.quantity_conversion_method,\n  mm.internal_object_number,\n  mm.environmentally_relevant,\n  mm.product_allocation,\n  mm.pricing_profile,\n  mm.discount_in_kind,\n  mm.manufacturer_part_number,\n  mm.manufacturer_number,\n  mm.inventory_material_number,\n  mm.manufacturer_part_profile,\n  mm.units_of_measure_usage,\n  mm.rollout_season,\n  mm.dangerous_goods_indicator_profile,\n  mm.highly_viscous,\n  mm.in_bulk_liquid,\n  mm.serialization_level,\n  mm.closed,\n  mm.approved_batch_record_required,\n  mm.assign_effectivity_values,\n  mm.material_completion_level,\n  mm.shelf_life_expiration_date,\n  mm.rounding_rule_sled,\n  mm.product_composition,\n  mm.general_category_group,\n  mm.logistical_variants,\n  mm.cw_material,\n  mm.valuation_unit_of_measure,\n  mm.cw_tolerance_group,\n  mm.checkbox,\n  mm.base_unit_of_measure_1,\n  mm.nato_stock_number,\n  mm.internal_charactieristic_number,\n  mm.internal_char_number_main,\n  mm.internal_char_number_second,\n  mm.colors_of_variants,\n  mm.main_size,\n  mm.second_size,\n  mm.free_characteristic_value,\n  mm.care_code,\n  mm.brand,\n  mm.fiber_code_component_1,\n  mm.percentage_share_1,\n  mm.fiber_code_component_2,\n  mm.percentage_share_2,\n  mm.fiber_code_component_3,\n  mm.percentage_share_3,\n  mm.fiber_code_component_4,\n  mm.percentage_share_4,\n  mm.material_group_hierarchy_level_1,\n  mm.material_group_hierarchy_level_2,\n  mm.material_group_hierarchy_level_3,\n  mm.material_group_hierarchy_level_4,\n  mm.fashion_grade,\n  mde.language_key,\n  mde.material_description,\n  CASE WHEN mm.dw_last_update_date > mde.dw_last_update_date \n       THEN mm.dw_last_update_date\n       ELSE mde.dw_last_update_date\n  END AS input_last_update_date,\n  mm.dw_active_indicator\nFROM `${ProjectID}.${StagingDatasetName}.material_master` mm\n     INNER JOIN `${ProjectID}.${StagingDatasetName}.material_description` mde\n  ON mde.material_number = mm.material_number\n AND mde.dw_active_indicator = mm.dw_active_indicator\n AND mde.language_key IN ('E','EN')\n     INNER JOIN `${ProjectID}.${StagingDatasetName}.layer1_audit_table` lat\n  ON 1 = 1\n AND lat.table_name = 'material_dimension' \n     INNER JOIN `${ProjectID}.${TargetDatasetName}.material_dimension` md\n  ON mm.material_group = md.material_group\n AND mm.material_number = md.material_number\n AND mm.industry_sector = md.industry_sector\n AND mm.material_type = md.material_type\nWHERE mm.dw_active_indicator = 'Y'\n  AND (mm.dw_last_update_date >= CASE WHEN lat.full_delta_indicator = 'F' THEN lat.full_load_datetime\n                                        WHEN lat.full_delta_indicator <> 'F' THEN lat.delta_load_datetime\n                                        ELSE CAST('1900-01-01T00:00:00' AS DATETIME)\n                                   END\n    OR mde.dw_last_update_date >= CASE WHEN lat.full_delta_indicator = 'F' THEN lat.full_load_datetime\n                                        WHEN lat.full_delta_indicator <> 'F' THEN lat.delta_load_datetime\n                                        ELSE CAST('1900-01-01T00:00:00' AS DATETIME)\n                                   END)\n) scr\nON   tgt.material_group = scr.material_group_join_key\n AND tgt.material_number = scr.material_number_join_key\n AND tgt.industry_sector = scr.industry_sector_join_key\n AND tgt.material_type = scr.material_type_join_key\nWHEN MATCHED THEN \nUPDATE set tgt.dw_end_date = CURRENT_DATETIME()\n          ,tgt.dw_active_indicator = 'N'\nWHEN NOT MATCHED THEN \nINSERT (material_uuid,\nmaterial_group,\nmaterial_number,\nindustry_sector,\nmaterial_type,\ncreated_on,\ncreated_by,\nlast_change,\nchanged_by,\ncomplete_material_status,\nmaintenance_status,\nclient_level_deletion_flag,\nold_material_number,\nbase_unit_of_measure,\npurchase_order_unit,\ndocument_number,\ndocument_type,\ndocument_version,\npage_format_2,\ndocument_change_number,\npage_number,\nnumber_of_sheets,\nproduction_memo,\npage_format_1,\nsize_dimensions,\nbasic_material,\nindustry_standard_description,\nlaboratory_design_office,\npurchasing_value_key,\ngross_weight,\nnet_weight,\nweight_unit,\nvolume,\nvolume_unit_2,\ncontainer_requirements,\nstorage_conditions,\ntemperature_conditions_indicator,\nlow_level_code,\ntransportation_group,\nhazardous_material_number,\ndivision,\ncustomer_number,\neuropean_article_number,\ngoods_receipt_slips_quantity,\nprocurement_rule,\nsource_of_supply,\nseason_category,\nlabel_type,\nlabel_form,\ndisposal_type,\ninternational_article_number,\nean_category,\nmaterial_length,\nmaterial_width,\nmaterial_height,\nunit_of_dimension,\nproduct_hierarchy,\nnet_change_costing,\ncad_indicator,\nqm_procurement,\nallowed_packaging_weight,\nunit_of_weight,\nallowed_packaging_volume,\nvolume_unit_1,\nexcess_weight_tolerance,\nexcess_volume_tolerance,\nvariable_purchase_order_unit_active,\nrevision_level_assigned,\nconfigurable_material,\nbatch_management_requirement,\npackaging_material_type,\nmaximum_level,\nstacking_factor,\nmaterial_group_packaging_materials,\nauthorization_group,\nvalid_from,\ndeletion_date,\nseason_year,\nprice_band_category,\nempties_bill_of_material,\nexternal_material_group,\ncross_plant_configurable_material,\nmaterial_category,\nmaterial_co_product,\nfollow_up_material,\npricing_reference_material,\ncross_plant_material_status,\ncross_distribution_chain_status,\ncross_plant_valid_from,\ncross_distribution_valid_from,\ntax_classification,\ncatalog_profile,\nminimum_remaining_shelf_life,\ntotal_shelf_life,\nstorage_percentage,\ncontent_unit,\nnet_contents,\ncomparison_price_unit,\nlabeling_material_grouping,\ngross_contents,\nquantity_conversion_method,\ninternal_object_number,\nenvironmentally_relevant,\nproduct_allocation,\npricing_profile,\ndiscount_in_kind,\nmanufacturer_part_number,\nmanufacturer_number,\ninventory_material_number,\nmanufacturer_part_profile,\nunits_of_measure_usage,\nrollout_season,\ndangerous_goods_indicator_profile,\nhighly_viscous,\nin_bulk_liquid,\nserialization_level,\nclosed,\napproved_batch_record_required,\nassign_effectivity_values,\nmaterial_completion_level,\nshelf_life_expiration_date,\nrounding_rule_sled,\nproduct_composition,\ngeneral_category_group,\nlogistical_variants,\ncw_material,\nvaluation_unit_of_measure,\ncw_tolerance_group,\ncheckbox,\nbase_unit_of_measure_1,\nnato_stock_number,\ninternal_charactieristic_number,\ninternal_char_number_main,\ninternal_char_number_second,\ncolors_of_variants,\nmain_size,\nsecond_size,\nfree_characteristic_value,\ncare_code,\nbrand,\nfiber_code_component_1,\npercentage_share_1,\nfiber_code_component_2,\npercentage_share_2,\nfiber_code_component_3,\npercentage_share_3,\nfiber_code_component_4,\npercentage_share_4,\nmaterial_group_hierarchy_level_1,\nmaterial_group_hierarchy_level_2,\nmaterial_group_hierarchy_level_3,\nmaterial_group_hierarchy_level_4,\nfashion_grade,\nlanguage_key,\nmaterial_description,\ninput_last_update_date,\ndw_active_indicator,\ndw_start_date,\ndw_end_date,\ndw_last_update_date)\nVALUES (GENERATE_UUID(),\nscr.material_group,\nscr.material_number,\nscr.industry_sector,\nscr.material_type,\nscr.created_on,\nscr.created_by,\nscr.last_change,\nscr.changed_by,\nscr.complete_material_status,\nscr.maintenance_status,\nscr.client_level_deletion_flag,\nscr.old_material_number,\nscr.base_unit_of_measure,\nscr.purchase_order_unit,\nscr.document_number,\nscr.document_type,\nscr.document_version,\nscr.page_format_2,\nscr.document_change_number,\nscr.page_number,\nscr.number_of_sheets,\nscr.production_memo,\nscr.page_format_1,\nscr.size_dimensions,\nscr.basic_material,\nscr.industry_standard_description,\nscr.laboratory_design_office,\nscr.purchasing_value_key,\nscr.gross_weight,\nscr.net_weight,\nscr.weight_unit,\nscr.volume,\nscr.volume_unit_2,\nscr.container_requirements,\nscr.storage_conditions,\nscr.temperature_conditions_indicator,\nscr.low_level_code,\nscr.transportation_group,\nscr.hazardous_material_number,\nscr.division,\nscr.customer_number,\nscr.european_article_number,\nscr.goods_receipt_slips_quantity,\nscr.procurement_rule,\nscr.source_of_supply,\nscr.season_category,\nscr.label_type,\nscr.label_form,\nscr.disposal_type,\nscr.international_article_number,\nscr.ean_category,\nscr.length,\nscr.width,\nscr.height,\nscr.unit_of_dimension,\nscr.product_hierarchy,\nscr.net_change_costing,\nscr.cad_indicator,\nscr.qm_procurement,\nscr.allowed_packaging_weight,\nscr.unit_of_weight,\nscr.allowed_packaging_volume,\nscr.volume_unit_1,\nscr.excess_weight_tolerance,\nscr.excess_volume_tolerance,\nscr.variable_purchase_order_unit_active,\nscr.revision_level_assigned,\nscr.configurable_material,\nscr.batch_management_requirement,\nscr.packaging_material_type,\nscr.maximum_level,\nscr.stacking_factor,\nscr.material_group_packaging_materials,\nscr.authorization_group,\nscr.valid_from,\nscr.deletion_date,\nscr.season_year,\nscr.price_band_category,\nscr.empties_bill_of_material,\nscr.external_material_group,\nscr.cross_plant_configurable_material,\nscr.material_category,\nscr.material_co_product,\nscr.follow_up_material,\nscr.pricing_reference_material,\nscr.cross_plant_material_status,\nscr.cross_distribution_chain_status,\nscr.cross_plant_valid_from,\nscr.cross_distribution_valid_from,\nscr.tax_classification,\nscr.catalog_profile,\nscr.minimum_remaining_shelf_life,\nscr.total_shelf_life,\nscr.storage_percentage,\nscr.content_unit,\nscr.net_contents,\nscr.comparison_price_unit,\nscr.labeling_material_grouping,\nscr.gross_contents,\nscr.quantity_conversion_method,\nscr.internal_object_number,\nscr.environmentally_relevant,\nscr.product_allocation,\nscr.pricing_profile,\nscr.discount_in_kind,\nscr.manufacturer_part_number,\nscr.manufacturer_number,\nscr.inventory_material_number,\nscr.manufacturer_part_profile,\nscr.units_of_measure_usage,\nscr.rollout_season,\nscr.dangerous_goods_indicator_profile,\nscr.highly_viscous,\nscr.in_bulk_liquid,\nscr.serialization_level,\nscr.closed,\nscr.approved_batch_record_required,\nscr.assign_effectivity_values,\nscr.material_completion_level,\nscr.shelf_life_expiration_date,\nscr.rounding_rule_sled,\nscr.product_composition,\nscr.general_category_group,\nscr.logistical_variants,\nscr.cw_material,\nscr.valuation_unit_of_measure,\nscr.cw_tolerance_group,\nscr.checkbox,\nscr.base_unit_of_measure_1,\nscr.nato_stock_number,\nscr.internal_charactieristic_number,\nscr.internal_char_number_main,\nscr.internal_char_number_second,\nscr.colors_of_variants,\nscr.main_size,\nscr.second_size,\nscr.free_characteristic_value,\nscr.care_code,\nscr.brand,\nscr.fiber_code_component_1,\nscr.percentage_share_1,\nscr.fiber_code_component_2,\nscr.percentage_share_2,\nscr.fiber_code_component_3,\nscr.percentage_share_3,\nscr.fiber_code_component_4,\nscr.percentage_share_4,\nscr.material_group_hierarchy_level_1,\nscr.material_group_hierarchy_level_2,\nscr.material_group_hierarchy_level_3,\nscr.material_group_hierarchy_level_4,\nscr.fashion_grade,\nscr.language_key,\nscr.material_description,\nscr.input_last_update_date,\nscr.dw_active_indicator,\nCURRENT_DATETIME(),\nDATETIME(9999, 12, 31, 23, 59, 59),\nCURRENT_DATETIME());\n",
                        "dialect": "standard",
                        "mode": "batch",
                        "dataset": "${TargetDatasetName}",
                        "table": "material_dimension",
                        "useCache": "false",
                        "location": "US",
                        "rowAsArguments": "false",
                        "serviceAccountType": "filePath",
                        "serviceFilePath": "auto-detect"
                    }
                },
                "outputSchema": [
                    {
                        "name": "etlSchemaBody",
                        "schema": ""
                    }
                ],
                "id": "Merge-Statement"
            },
            {
                "name": "Update Audit Table",
                "plugin": {
                    "name": "BigQueryExecute",
                    "type": "action",
                    "label": "Update Audit Table",
                    "artifact": {
                        "name": "google-cloud",
                        "version": "0.17.0",
                        "scope": "SYSTEM"
                    },
                    "properties": {
                        "project": "auto-detect",
                        "sql": "MERGE INTO \n`${ProjectID}.${StagingDatasetName}.layer1_audit_table` tgt\nUSING ( SELECT \n         'material_dimension' as table_name\n         ,CASE WHEN (select full_delta_indicator from `${ProjectID}.${StagingDatasetName}.layer1_audit_table` where table_name = 'material_dimension') IS NULL\n                    OR (select full_delta_indicator from `${ProjectID}.${StagingDatasetName}.layer1_audit_table` where table_name = 'material_dimension') = 'F'\n               THEN 'F'\n               ELSE 'D'\n          END AS full_delta_indicator\n        ,'0MATERIAL_ATTR,0MATERIAL_TEXT' as extractors_names\n        ,CAST('1900-01-01T00:00:00' AS DATETIME) as full_load_datetime\n        ,(select max(input_last_update_date) as delta_load_datatime from `${ProjectID}.${TargetDatasetName}.material_dimension`) as delta_load_datetime\n        ,(select COUNT(*) AS inserted_record_count from `${ProjectID}.${TargetDatasetName}.material_dimension` a inner join `${ProjectID}.${StagingDatasetName}.layer1_audit_table` b\n          on 1 = 1 where b.table_name = 'material_dimension' and  a.dw_last_update_date > CASE WHEN b.full_delta_indicator = 'F' \n                                                                                               THEN b.full_load_datetime\n                                                                                               ELSE b.delta_load_datetime\n                                                                                          END\n          and a.dw_active_indicator = 'Y') AS inserted_record_count\n        ,CURRENT_DATETIME() as last_update_date\n) scr\non tgt.table_name = scr.table_name\nWHEN MATCHED THEN \nUPDATE set tgt.full_load_datetime ='1900-01-01T00:00:00'\n          ,tgt.delta_load_datetime = scr.delta_load_datetime\n          ,tgt.inserted_record_count = scr.inserted_record_count\n          ,tgt.last_update_date = scr.last_update_date\nWHEN NOT MATCHED THEN\nINSERT (table_name,\n        full_delta_indicator,\n        extractors_names,\n        full_load_datetime,\n        delta_load_datetime,\n        inserted_record_count,\n        last_update_date)\nVALUES(scr.table_name,\n       scr.full_delta_indicator,\n       scr.extractors_names,\n       scr.full_load_datetime,\n       scr.delta_load_datetime,\n       scr.inserted_record_count,\n       scr.last_update_date);",
                        "dialect": "standard",
                        "mode": "batch",
                        "dataset": "${StagingDatasetName}",
                        "table": "layer1_audit_table",
                        "useCache": "false",
                        "location": "US",
                        "rowAsArguments": "false",
                        "serviceAccountType": "filePath",
                        "serviceFilePath": "auto-detect"
                    }
                },
                "outputSchema": [
                    {
                        "name": "etlSchemaBody",
                        "schema": ""
                    }
                ],
                "id": "Update-Audit-Table"
            }
        ],
        "schedule": "0 * * * *",
        "engine": "spark",
        "numOfRecordsPreview": 100,
        "description": "material dimension",
        "maxConcurrentRuns": 1
    }
}