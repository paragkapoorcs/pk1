{
    "name": "inventory_fact",
    "description": "inventory fact",
    "artifact": {
        "name": "cdap-data-pipeline",
        "version": "6.4.0",
        "scope": "SYSTEM"
    },
    "config": {
        "resources": {
            "memoryMB": 2048,
            "virtualCores": 1
        },
        "driverResources": {
            "memoryMB": 2048,
            "virtualCores": 1
        },
        "connections": [
            {
                "from": "Merge Statement",
                "to": "Update Audit Table"
            }
        ],
        "comments": [],
        "postActions": [],
        "properties": {},
        "processTimingEnabled": true,
        "stageLoggingEnabled": false,
        "stages": [
            {
                "name": "Merge Statement",
                "plugin": {
                    "name": "BigQueryExecute",
                    "type": "action",
                    "label": "Merge Statement",
                    "artifact": {
                        "name": "google-cloud",
                        "version": "0.17.0",
                        "scope": "SYSTEM"
                    },
                    "properties": {
                        "project": "auto-detect",
                        "sql": "MERGE INTO `${ProjectID}.scl_sap_facts.inventory_fact` tgt\nUSING( \nWITH tmp_scr AS (SELECT \n(cast(si.posting_date as string) || '-' || si.material_number || '-' || si.plant || '-' || si.storage_location) as inventory_key,\nsi.material_number,\nsi.plant,\nsi.vendors_account_number,\nsi.posting_date,\nmpd.maintenance_status,\nmpd.plant_level_deletion_flag,\nmpd.valuation_category,\nmpd.batch_management_indicator,\nmpd.plant_specific_material_status,\nmpd.valid_from,\nmpd.abc_indicator,\nmpd.critical_part,\nmpd.purchasing_group,\nmpd.unit_of_issue,\nmpd.mrp_profile,\nmpd.mrp_type,\nmpd.mrp_controller,\nmpd.mrp_controller_buyer,\nmpd.planned_deliv_time,\nmpd.goods_receipt_processing_time,\nmpd.period_indicator,\nmpd.assembly_scrap,\nmpd.lot_sizing_procedure,\nmpd.procurement_type,\nmpd.special_procurement_type,\nmpd.dependent_requirements_indicator,\nmpd.storage_costs_code,\nmpd.selection_method,\nmpd.discontinuation_indicator,\nmpd.effective_out_date,\nmpd.follow_up_material,\nmpd.requirements_group,\nmpd.mixed_mrp_indicator,\nmpd.scheduling_margin_key,\nmpd.automatic_fixing_planned_orders,\nmpd.automatic_release,\nmpd.backflush,\nmpd.production_supervisor,\nmpd.processing_time,\nmpd.setup_time,\nmpd.interoperation_time,\nmpd.in_house_production,\nmpd.maximum_storage_period,\nmpd.time_unit,\nmpd.withdrawal_production_bin,\nmpd.rough_cut_planning,\nmpd.overdelivery_tolerance_limit,\nmpd.unlimited_overdelivery_allowed,\nmpd.underdely_tolerance,\nmpd.total_replenishment_lead_time,\nmpd.replacement_part,\nmpd.surcharge_factor_percent,\nmpd.state_of_manufacture,\nmpd.stock_type,\nmpd.sample_percentage,\nmpd.quarantine_period,\nmpd.qm_control_key,\nmpd.mean_inspection_duration,\nmpd.inspection_plan_indicator,\nmpd.documentation_required,\nmpd.active_substance,\nmpd.inspection_interval,\nmpd.next_inspection,\nmpd.loading_group,\nmpd.batch_management_requirement,\nmpd.quota_arrangement_usage,\nmpd.service_level,\nmpd.splitting_indicator,\nmpd.plan_version,\nmpd.object_type,\nmpd.object_id,\nmpd.availability_check,\nmpd.fiscal_year_variant,\nmpd.correction_factors,\nmpd.shipping_setup_time,\nmpd.shipping_processing_time,\nmpd.delivery_cycle,\nmpd.source_of_supply,\nmpd.automatic_purchase_order,\nmpd.source_list,\nmpd.commodity_code,\nmpd.country_of_origin,\nmpd.region_of_origin,\nmpd.commodity_code_unit,\nmpd.intrastat_material_group,\nmpd.profit_center,\nmpd.planning_calendar,\nmpd.repetitive_manufacturing,\nmpd.planning_time_fence,\nmpd.consumption_mode,\nmpd.backward_consumption_period,\nmpd.forward_consumption_period,\nmpd.version_indicator,\nmpd.alternative_bom,\nmpd.bom_usage,\nmpd.task_list_group,\nmpd.group_counter,\nmpd.special_procurement_costing,\nmpd.production_unit,\nmpd.production_storage_location,\nmpd.mrp_group,\nmpd.component_scrap,\nmpd.certificate_type,\nmpd.inspection_setup,\nmpd.takt_time,\nmpd.coverage_profile,\nmpd.local_field_name,\nmpd.physical_inventory_indicator,\nmpd.variance_key,\nmpd.serial_number_profile,\nmpd.internal_object_number,\nmpd.configurable_material,\nmpd.repetitive_manufacturing_profile,\nmpd.negative_stocks,\nmpd.target_qm_system,\nmpd.planning_cycle,\nmpd.rounding_profile,\nmpd.reference_material_for_consumption,\nmpd.reference_plant_for_consumption,\nmpd.date_of_material,\nmpd.multiplier_for_reference_material,\nmpd.reset_automatically,\nmpd.customs_preference,\nmpd.exemption_certificate,\nmpd.exemption_certificate_number,\nmpd.issue_date_certificate,\nmpd.vendor_declaration_code,\nmpd.vendor_declaration_date,\nmpd.military_goods,\nmpd.isr_service_level,\nmpd.material_co_product,\nmpd.planning_strategy_group,\nmpd.material_internal_object_number,\nmpd.storage_location_external_procurement,\nmpd.bulk_material,\nmpd.cc_indicator_fixed,\nmpd.withdrawal_sequence_group,\nmpd.qm_material_authorization,\nmpd.adjustment_period,\nmpd.task_list_type,\nmpd.uom_group,\nmpd.conversion_group,\nmpd.air_bouyancy_factor,\nmpd.production_scheduling_profile,\nmpd.safety_time_indicator,\nmpd.safety_time,\nmpd.action_control,\nmpd.batch_entry,\nmpd.controlling_area,\nsi.valuation_class,\nsi.logistics_stock_values,\nsi.stock_category_logistics,\nsi.application_component,\nsi.cost_value_local_currency,\nsi.retail_value_local_currency,\nsi.retail_tax_local_currency,\nsi.valuation_area,\nsi.quantity_in_base_unit,\nsi.wbs_element_external,\nsi.valuation_type,\nsi.batch_number,\nsi.sales_order_number,\nsi.sales_order_item,\nsi.customer_number,\nsi.special_stock_valuation,\nsi.storage_location,\nsi.base_unit_of_measure,\nsi.wbs_element,\nsi.special_stock_indicator,\nsi.currency_key,\nsi.item_type,\nsi.record_type_ea_rt,\nsi.material_category,\nsi.plant_category,\nCASE WHEN mpd.dw_last_update_date > si.dw_last_update_date\n     THEN mpd.dw_last_update_date\n     ELSE si.dw_last_update_date\nEND as input_last_update_date,\nmpd.dw_active_indicator,\nmd.material_uuid,\npd.plant_uuid,\nsd.supplier_uuid,\ncd.customer_uuid,\n(si.material_number || '-' || si.plant) as material_key,\nsi.plant as plant_key,\nsi.vendors_account_number as supplier_key,\nsi.customer_number as customer_key\n  FROM `${ProjectID}.${StagingDatasetName}.material_plant_data` mpd \n        INNER JOIN `${ProjectID}.${StagingDatasetName}.stock_initialization` si \n    ON si.material_number = mpd.material_number\n   AND si.plant = mpd.plant\n   AND si.dw_active_indicator = 'Y'\n       LEFT JOIN `${ProjectID}.${StagingDatasetName}.layer1_audit_table` lat\n    ON 1 = 1\n   AND lat.table_name = 'inventory_fact' \n       INNER JOIN `${ProjectID}.${TargetDatasetNames2}.material_dimension` md  \n    ON md.dw_active_indicator = 'Y'\n   AND md.material_key = (si.material_number || '-' || si.plant)\n       INNER JOIN `${ProjectID}.${TargetDatasetNames2}.plant_dimension` pd  \n    ON pd.dw_active_indicator = 'Y'\n   AND pd.plant_key = si.plant\n       LEFT JOIN `${ProjectID}.${TargetDatasetNames2}.supplier_dimension` sd \n    ON sd.dw_active_indicator = 'Y'\n   AND sd.supplier_key = si.vendors_account_number\n       LEFT JOIN `${ProjectID}.${TargetDatasetNames2}.customer_dimension` cd \n    ON cd.dw_active_indicator = 'Y'\n   AND cd.customer_key = si.customer_number\n WHERE mpd.dw_active_indicator = 'Y'\n   AND (mpd.dw_last_update_date >= CASE WHEN lat.full_delta_indicator = 'F' THEN lat.full_load_datetime\n                                        WHEN lat.full_delta_indicator <> 'F' THEN lat.delta_load_datetime\n                                        ELSE CAST('1900-01-01T00:00:00' AS DATETIME)\n                                   END\n    OR  si.dw_last_update_date >= CASE WHEN lat.full_delta_indicator = 'F' THEN lat.full_load_datetime\n                                        WHEN lat.full_delta_indicator <> 'F' THEN lat.delta_load_datetime\n                                        ELSE CAST('1900-01-01T00:00:00' AS DATETIME)\n                                  END)),\n  temp_inv AS (SELECT ts.*,\n     TO_HEX(MD5((select string_agg(CAST(col as STRING), ', ' order by offset)\n    from unnest(split(trim(format('%t',(select as struct ts.* except(input_last_update_date))), '()'),', ')) col with offset \n    where not col IS NULL\n    ))) as finalmd5key      \n  from tmp_scr ts)\nSELECT t.inventory_key as inventory_join_key,t.*\n  from temp_inv t\nunion all \nSELECT NULL as inventory_join_key,t.*\n  from temp_inv t\n       INNER JOIN `${ProjectID}.scl_sap_facts.inventory_fact` inf\n    ON inf.dw_active_indicator ='Y'\n   AND inf.inventory_key = t.inventory_key\n   AND inf.finalmd5key <> t.finalmd5key) scr\nON tgt.inventory_key = scr.inventory_join_key\nWHEN MATCHED AND tgt.finalmd5key <> scr.finalmd5key THEN\nUPDATE set tgt.dw_end_date = CURRENT_DATETIME()\n          ,tgt.dw_active_indicator = 'N'\nWHEN NOT MATCHED THEN \nINSERT (\ninventory_uuid,\ninventory_key,\nmaterial_number,\nplant,\nvendors_account_number,\nposting_date,\nmaterial_uuid,\nplant_uuid,\nsupplier_uuid,\ncustomer_uuid,\nmaterial_key,\nplant_key,\ncustomer_key,\nsupplier_key,\nmaintenance_status,\nplant_level_deletion_flag,\nvaluation_category,\nbatch_management_indicator,\nplant_specific_material_status,\nvalid_from,\nabc_indicator,\ncritical_part,\npurchasing_group,\nunit_of_issue,\nmrp_profile,\nmrp_type,\nmrp_controller,\nmrp_controller_buyer,\nplanned_deliv_time,\ngoods_receipt_processing_time,\nperiod_indicator,\nassembly_scrap,\nlot_sizing_procedure,\nprocurement_type,\nspecial_procurement_type,\ndependent_requirements_indicator,\nstorage_costs_code,\nselection_method,\ndiscontinuation_indicator,\neffective_out_date,\nfollow_up_material,\nrequirements_group,\nmixed_mrp_indicator,\nscheduling_margin_key,\nautomatic_fixing_planned_orders,\nautomatic_release,\nbackflush,\nproduction_supervisor,\nprocessing_time,\nsetup_time,\ninteroperation_time,\nin_house_production,\nmaximum_storage_period,\ntime_unit,\nwithdrawal_production_bin,\nrough_cut_planning,\noverdelivery_tolerance_limit,\nunlimited_overdelivery_allowed,\nunderdely_tolerance,\ntotal_replenishment_lead_time,\nreplacement_part,\nsurcharge_factor_percent,\nstate_of_manufacture,\nstock_type,\nsample_percentage,\nquarantine_period,\nqm_control_key,\nmean_inspection_duration,\ninspection_plan_indicator,\ndocumentation_required,\nactive_substance,\ninspection_interval,\nnext_inspection,\nloading_group,\nbatch_management_requirement,\nquota_arrangement_usage,\nservice_level,\nsplitting_indicator,\nplan_version,\nobject_type,\nobject_id,\navailability_check,\nfiscal_year_variant,\ncorrection_factors,\nshipping_setup_time,\nshipping_processing_time,\ndelivery_cycle,\nsource_of_supply,\nautomatic_purchase_order,\nsource_list,\ncommodity_code,\ncountry_of_origin,\nregion_of_origin,\ncommodity_code_unit,\nintrastat_material_group,\nprofit_center,\nplanning_calendar,\nrepetitive_manufacturing,\nplanning_time_fence,\nconsumption_mode,\nbackward_consumption_period,\nforward_consumption_period,\nversion_indicator,\nalternative_bom,\nbom_usage,\ntask_list_group,\ngroup_counter,\nspecial_procurement_costing,\nproduction_unit,\nproduction_storage_location,\nmrp_group,\ncomponent_scrap,\ncertificate_type,\ninspection_setup,\ntakt_time,\ncoverage_profile,\nlocal_field_name,\nphysical_inventory_indicator,\nvariance_key,\nserial_number_profile,\ninternal_object_number,\nconfigurable_material,\nrepetitive_manufacturing_profile,\nnegative_stocks,\ntarget_qm_system,\nplanning_cycle,\nrounding_profile,\nreference_material_for_consumption,\nreference_plant_for_consumption,\ndate_of_material,\nmultiplier_for_reference_material,\nreset_automatically,\ncustoms_preference,\nexemption_certificate,\nexemption_certificate_number,\nissue_date_certificate,\nvendor_declaration_code,\nvendor_declaration_date,\nmilitary_goods,\nisr_service_level,\nmaterial_co_product,\nplanning_strategy_group,\nmaterial_internal_object_number,\nstorage_location_external_procurement,\nbulk_material,\ncc_indicator_fixed,\nwithdrawal_sequence_group,\nqm_material_authorization,\nadjustment_period,\ntask_list_type,\nuom_group,\nconversion_group,\nair_bouyancy_factor,\nproduction_scheduling_profile,\nsafety_time_indicator,\nsafety_time,\naction_control,\nbatch_entry,\ncontrolling_area,\nvaluation_class,\nlogistics_stock_values,\nstock_category_logistics,\napplication_component,\ncost_value_local_currency,\nretail_value_local_currency,\nretail_tax_local_currency,\nvaluation_area,\nquantity_in_base_unit,\nwbs_element_external,\nvaluation_type,\nbatch_number,\nsales_order_number,\nsales_order_item,\ncustomer_number,\nspecial_stock_valuation,\nstorage_location,\nbase_unit_of_measure,\nwbs_element,\nspecial_stock_indicator,\ncurrency_key,\nitem_type,\nrecord_type_ea_rt,\nmaterial_category,\nplant_category,\ninput_last_update_date,\nfinalmd5key,\ndw_active_indicator,\ndw_start_date,\ndw_end_date,\ndw_last_update_date \n)VALUES(TO_HEX(MD5(scr.inventory_key)),\nscr.inventory_key,\nscr.material_number,\nscr.plant,\nscr.vendors_account_number,\nscr.posting_date,\nscr.material_uuid,\nscr.plant_uuid,\nscr.supplier_uuid,\nscr.customer_uuid,\nscr.material_key,\nscr.plant_key,\nscr.customer_key,\nscr.supplier_key,\nscr.maintenance_status,\nscr.plant_level_deletion_flag,\nscr.valuation_category,\nscr.batch_management_indicator,\nscr.plant_specific_material_status,\nscr.valid_from,\nscr.abc_indicator,\nscr.critical_part,\nscr.purchasing_group,\nscr.unit_of_issue,\nscr.mrp_profile,\nscr.mrp_type,\nscr.mrp_controller,\nscr.mrp_controller_buyer,\nscr.planned_deliv_time,\nscr.goods_receipt_processing_time,\nscr.period_indicator,\nscr.assembly_scrap,\nscr.lot_sizing_procedure,\nscr.procurement_type,\nscr.special_procurement_type,\nscr.dependent_requirements_indicator,\nscr.storage_costs_code,\nscr.selection_method,\nscr.discontinuation_indicator,\nscr.effective_out_date,\nscr.follow_up_material,\nscr.requirements_group,\nscr.mixed_mrp_indicator,\nscr.scheduling_margin_key,\nscr.automatic_fixing_planned_orders,\nscr.automatic_release,\nscr.backflush,\nscr.production_supervisor,\nscr.processing_time,\nscr.setup_time,\nscr.interoperation_time,\nscr.in_house_production,\nscr.maximum_storage_period,\nscr.time_unit,\nscr.withdrawal_production_bin,\nscr.rough_cut_planning,\nscr.overdelivery_tolerance_limit,\nscr.unlimited_overdelivery_allowed,\nscr.underdely_tolerance,\nscr.total_replenishment_lead_time,\nscr.replacement_part,\nscr.surcharge_factor_percent,\nscr.state_of_manufacture,\nscr.stock_type,\nscr.sample_percentage,\nscr.quarantine_period,\nscr.qm_control_key,\nscr.mean_inspection_duration,\nscr.inspection_plan_indicator,\nscr.documentation_required,\nscr.active_substance,\nscr.inspection_interval,\nscr.next_inspection,\nscr.loading_group,\nscr.batch_management_requirement,\nscr.quota_arrangement_usage,\nscr.service_level,\nscr.splitting_indicator,\nscr.plan_version,\nscr.object_type,\nscr.object_id,\nscr.availability_check,\nscr.fiscal_year_variant,\nscr.correction_factors,\nscr.shipping_setup_time,\nscr.shipping_processing_time,\nscr.delivery_cycle,\nscr.source_of_supply,\nscr.automatic_purchase_order,\nscr.source_list,\nscr.commodity_code,\nscr.country_of_origin,\nscr.region_of_origin,\nscr.commodity_code_unit,\nscr.intrastat_material_group,\nscr.profit_center,\nscr.planning_calendar,\nscr.repetitive_manufacturing,\nscr.planning_time_fence,\nscr.consumption_mode,\nscr.backward_consumption_period,\nscr.forward_consumption_period,\nscr.version_indicator,\nscr.alternative_bom,\nscr.bom_usage,\nscr.task_list_group,\nscr.group_counter,\nscr.special_procurement_costing,\nscr.production_unit,\nscr.production_storage_location,\nscr.mrp_group,\nscr.component_scrap,\nscr.certificate_type,\nscr.inspection_setup,\nscr.takt_time,\nscr.coverage_profile,\nscr.local_field_name,\nscr.physical_inventory_indicator,\nscr.variance_key,\nscr.serial_number_profile,\nscr.internal_object_number,\nscr.configurable_material,\nscr.repetitive_manufacturing_profile,\nscr.negative_stocks,\nscr.target_qm_system,\nscr.planning_cycle,\nscr.rounding_profile,\nscr.reference_material_for_consumption,\nscr.reference_plant_for_consumption,\nscr.date_of_material,\nscr.multiplier_for_reference_material,\nscr.reset_automatically,\nscr.customs_preference,\nscr.exemption_certificate,\nscr.exemption_certificate_number,\nscr.issue_date_certificate,\nscr.vendor_declaration_code,\nscr.vendor_declaration_date,\nscr.military_goods,\nscr.isr_service_level,\nscr.material_co_product,\nscr.planning_strategy_group,\nscr.material_internal_object_number,\nscr.storage_location_external_procurement,\nscr.bulk_material,\nscr.cc_indicator_fixed,\nscr.withdrawal_sequence_group,\nscr.qm_material_authorization,\nscr.adjustment_period,\nscr.task_list_type,\nscr.uom_group,\nscr.conversion_group,\nscr.air_bouyancy_factor,\nscr.production_scheduling_profile,\nscr.safety_time_indicator,\nscr.safety_time,\nscr.action_control,\nscr.batch_entry,\nscr.controlling_area,\nscr.valuation_class,\nscr.logistics_stock_values,\nscr.stock_category_logistics,\nscr.application_component,\nscr.cost_value_local_currency,\nscr.retail_value_local_currency,\nscr.retail_tax_local_currency,\nscr.valuation_area,\nscr.quantity_in_base_unit,\nscr.wbs_element_external,\nscr.valuation_type,\nscr.batch_number,\nscr.sales_order_number,\nscr.sales_order_item,\nscr.customer_number,\nscr.special_stock_valuation,\nscr.storage_location,\nscr.base_unit_of_measure,\nscr.wbs_element,\nscr.special_stock_indicator,\nscr.currency_key,\nscr.item_type,\nscr.record_type_ea_rt,\nscr.material_category,\nscr.plant_category,\nscr.input_last_update_date,\nscr.finalmd5key,\nscr.dw_active_indicator,\nCURRENT_DATETIME(),\nDATETIME(9999, 12, 31, 23, 59, 59),\nCURRENT_DATETIME());",
                        "dialect": "standard",
                        "mode": "batch",
                        "dataset": "${TargetDatasetNames1}",
                        "table": "inventory_fact",
                        "useCache": "false",
                        "location": "US",
                        "rowAsArguments": "false",
                        "serviceAccountType": "filePath",
                        "serviceFilePath": "auto-detect"
                    }
                },
                "outputSchema": [
                    {
                        "name": "etlSchemaBody",
                        "schema": ""
                    }
                ],
                "id": "Merge-Statement",
                "type": "action",
                "label": "Merge Statement",
                "icon": "fa-plug"
            },
            {
                "name": "Update Audit Table",
                "plugin": {
                    "name": "BigQueryExecute",
                    "type": "action",
                    "label": "Update Audit Table",
                    "artifact": {
                        "name": "google-cloud",
                        "version": "0.17.0",
                        "scope": "SYSTEM"
                    },
                    "properties": {
                        "project": "auto-detect",
                        "sql": "MERGE INTO \n`${ProjectID}.${StagingDatasetName}.layer1_audit_table` tgt\nUSING ( SELECT \n         'inventory_fact' as table_name\n         ,CASE WHEN (select full_delta_indicator from `${ProjectID}.${StagingDatasetName}.layer1_audit_table` where table_name = 'inventory_fact') IS NULL\n                    OR (select full_delta_indicator from `${ProjectID}.${StagingDatasetName}.layer1_audit_table` where table_name = 'inventory_fact') = 'F'\n               THEN 'F'\n               ELSE 'D'\n          END AS full_delta_indicator\n        ,'2LIS_03_BX,0MAT_PLANT_ATTR' as extractors_names\n        ,CAST('1900-01-01T00:00:00' AS DATETIME) as full_load_datetime\n        ,(select max(input_last_update_date) as delta_load_datatime from `${ProjectID}.scl_sap_facts.inventory_fact`) as delta_load_datetime\n        ,(select COUNT(*) AS inserted_record_count from `${ProjectID}.scl_sap_facts.inventory_fact` a inner join `${ProjectID}.${StagingDatasetName}.layer1_audit_table` b\n          on 1 = 1 where b.table_name = 'inventory_fact' and  a.dw_last_update_date > CASE WHEN b.full_delta_indicator = 'F' \n                                                                                             THEN b.full_load_datetime\n                                                                                             WHEN b.full_delta_indicator <> 'F'\n                                                                                             THEN b.delta_load_datetime\n                                                                                             ELSE CAST('1900-01-01T00:00:00' AS DATETIME)\n                                                                                        END\n          and a.dw_active_indicator = 'Y') AS inserted_record_count\n        ,CURRENT_DATETIME() as last_update_date\n) scr\non tgt.table_name = scr.table_name\nWHEN MATCHED THEN \nUPDATE set tgt.full_load_datetime ='1900-01-01T00:00:00'\n          ,tgt.delta_load_datetime = scr.delta_load_datetime\n          ,tgt.inserted_record_count = scr.inserted_record_count\n          ,tgt.last_update_date = scr.last_update_date\nWHEN NOT MATCHED THEN\nINSERT (table_name,\n        full_delta_indicator,\n        extractors_names,\n        full_load_datetime,\n        delta_load_datetime,\n        inserted_record_count,\n        last_update_date)\nVALUES(scr.table_name,\n       scr.full_delta_indicator,\n       scr.extractors_names,\n       scr.full_load_datetime,\n       scr.delta_load_datetime,\n       scr.inserted_record_count,\n       scr.last_update_date);\n",
                        "dialect": "standard",
                        "mode": "batch",
                        "dataset": "${StagingDatasetName}",
                        "table": "layer1_audit_table",
                        "useCache": "false",
                        "location": "US",
                        "rowAsArguments": "false",
                        "serviceAccountType": "filePath",
                        "serviceFilePath": "auto-detect"
                    }
                },
                "outputSchema": [
                    {
                        "name": "etlSchemaBody",
                        "schema": ""
                    }
                ],
                "id": "Update-Audit-Table",
                "type": "action",
                "label": "Update Audit Table",
                "icon": "fa-plug"
            }
        ],
        "schedule": "0 * * * *",
        "engine": "spark",
        "numOfRecordsPreview": 100,
        "description": "inventory fact",
        "maxConcurrentRuns": 1
    }
}