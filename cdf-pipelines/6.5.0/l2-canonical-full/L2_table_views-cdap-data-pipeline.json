{
    "name": "L2_table_views",
    "description": "L2 table views",
    "artifact": {
        "name": "cdap-data-pipeline",
        "version": "6.5.0",
        "scope": "SYSTEM"
    },
    "config": {
        "resources": {
            "memoryMB": 2048,
            "virtualCores": 1
        },
        "driverResources": {
            "memoryMB": 2048,
            "virtualCores": 1
        },
        "connections": [],
        "comments": [],
        "postActions": [],
        "properties": {},
        "processTimingEnabled": true,
        "stageLoggingEnabled": false,
        "stages": [
            {
                "name": "L2 table views",
                "plugin": {
                    "name": "BigQueryExecute",
                    "type": "action",
                    "label": "L2 table views",
                    "artifact": {
                        "name": "google-cloud",
                        "version": "0.18.0",
                        "scope": "SYSTEM"
                    },
                    "properties": {
                        "project": "auto-detect",
                        "sql": "CREATE OR REPLACE VIEW `${ProjectID}.${TargetDatasetNames3}.inventory_vw`\nAS\nSELECT invf.posting_date as inventory_date\n,'PRODUCT' || '-' || invf.material_key as product_uid\n,'PLANT' || '-' || invf.plant_key as location_uid\n,invf.batch_management_indicator AS batch_number\n,invf.stock_type AS inventory_type\n,invf.plant AS inventory_assignment\n,invf.quantity_in_base_unit inventory_quantity\n,CAST(NULL AS STRING) as remaining_shelf_life\n,CAST(NULL AS STRING) as inventory_block\n,CAST(NULL AS DATE) as inv_gr_date\n,pd.company_code as inventory_ownership\n,invf.valuation_area as valuation_area\nFROM `${ProjectID}.${TargetDatasetNames2}.inventory_fact` invf\n      LEFT JOIN `${ProjectID}.${TargetDatasetNames1}.plant_dimension` pd \n   ON invf.plant_key = pd.plant_key\nwhere invf.dw_active_indicator = 'Y';\n\nCREATE OR REPLACE VIEW `${ProjectID}.${TargetDatasetNames3}.legal_entity_vw`\nAS\nselect plant_uuid as uuid\n,'PLANT' || '-' || plant_key AS legal_enity_uid\n,'PLANT' AS legal_entity_type\n,plant AS legal_entity_id\n,company_code AS organization_level\n,name as legal_entity_name\n,name_2 as legal_entity_name2\n,street_house_number as house_number\n,street_house_number as street\n,city as city\n,po_box as postal_code\n,CAST(NULL AS STRING) as district\n,Region as region\n,country_key as country\n,CAST(NULL AS FLOAT64) as geo_lattitude\n,CAST(NULL AS FLOAT64) as geo_longitude\n,factory_calendar as time_zone\n,CAST(NULL AS STRING) as legal_entity_classification\n,CAST(NULL AS STRING) as legal_entity_group\n,CAST(NULL AS STRING) as reconcillation_account\n,CAST(NULL AS STRING) as payment_term\n,CAST(NULL AS STRING) as legal_entity_role\n,CAST(NULL AS DATE) as valid_from_date\n,CAST(NULL AS DATE) as valid_to_date\n,CAST(NULL AS STRING) as active\n,CAST(NULL AS DATE) as creation_date\n,CAST(NULL AS DATE) as change_date\n  from `${ProjectID}.${TargetDatasetNames1}.plant_dimension`\nwhere dw_active_indicator = 'Y'\nUNION ALL \nselect supplier_purchase_org_uuid as uuid\n,'SUPPLIER' || '-' || supplier_purchase_org_key AS legal_enity_uid\n,'SUPPLIER' AS legal_entity_type\n,vendors_account_number AS legal_entity_id\n,purchasing_organization AS organization_level\n,name_1 as legal_entity_name\n,name_2 as legal_entity_name2\n,street_and_house_number as house_number\n,street_and_house_number as street\n,city as city\n,postal_code as postal_code\n,district as district\n,region as region\n,country_key as country\n,CAST(NULL AS FLOAT64) as geo_lattitude\n,CAST(NULL AS FLOAT64) as geo_longitude\n,CAST(NULL AS STRING) as time_zone\n,CAST(NULL AS STRING) as legal_entity_classification\n,CAST(NULL AS STRING) as legal_entity_group\n,CAST(NULL AS STRING) as reconcillation_account\n,CAST(NULL AS STRING) as payment_term\n,CAST(NULL AS STRING) as legal_entity_role\n,CAST(NULL AS DATE) as valid_from_date\n,CAST(NULL AS DATE) as valid_to_date\n,CAST(NULL AS STRING) as active\n,created_on as creation_date\n,CAST(NULL AS DATE) as change_date\n  from `${ProjectID}.${TargetDatasetNames1}.supplier_purchase_org_dimension`\nwhere dw_active_indicator = 'Y'\nUNION ALL\nselect customer_sales_org_uuid as uuid\n,'CUSTOMER' || '-' || customer_sales_org_key AS legal_enity_uid\n,'CUSTOMER' AS legal_entity_type\n,customer_number AS legal_entity_id\n,(sales_organization || '-' || distribution_channel || '-' || division) AS organization_level\n,name_1 as legal_entity_name\n,name_2 as legal_entity_name2\n,street_and_house_number as house_number\n,street_and_house_number as street\n,city as city\n,postal_code as postal_code\n,district as district\n,region as region\n,country_key as country\n,CAST(NULL AS FLOAT64) as geo_lattitude\n,CAST(NULL AS FLOAT64) as geo_longitude\n,CAST(NULL AS STRING) as time_zone\n,CAST(NULL AS STRING) as legal_entity_classification\n,CAST(NULL AS STRING) as legal_entity_group\n,CAST(NULL AS STRING) as reconcillation_account\n,CAST(NULL AS STRING) as payment_term\n,CAST(NULL AS STRING) as legal_entity_role\n,CAST(NULL AS DATE) as valid_from_date\n,CAST(NULL AS DATE) as valid_to_date\n,CAST(NULL AS STRING) as active\n,created_on as creation_date\n,CAST(NULL AS DATE) as change_date\n  from `${ProjectID}.${TargetDatasetNames1}.customer_sales_org_dimension`\nwhere dw_active_indicator = 'Y'\nUNION ALL\nselect company_uuid as uuid\n,'COMPANY' || '-' || company_key AS legal_enity_uid\n,'COMPANY' AS legal_entity_type\n,company_code AS legal_entity_id\n,CAST(NULL AS STRING) AS organization_level\n,name_1 as legal_entity_name\n,name_2 as legal_entity_name2\n,house_number as house_number\n,street as street\n,city as city\n,po_box as postal_code\n,CAST(NULL AS STRING) as district\n,CAST(NULL AS STRING) as region\n,country_key as country\n,CAST(NULL AS FLOAT64) as geo_lattitude\n,CAST(NULL AS FLOAT64) as geo_longitude\n,CAST(NULL AS STRING) as time_zone\n,CAST(NULL AS STRING) as legal_entity_classification\n,CAST(NULL AS STRING) as legal_entity_group\n,CAST(NULL AS STRING) as reconcillation_account\n,CAST(NULL AS STRING) as payment_term\n,CAST(NULL AS STRING) as legal_entity_role\n,CAST(NULL AS DATE) as valid_from_date\n,CAST(NULL AS DATE) as valid_to_date\n,CAST(NULL AS STRING) as active\n,CAST(NULL AS DATE) as creation_date\n,CAST(NULL AS DATE) as change_date\n  from `${ProjectID}.${TargetDatasetNames1}.company_code_dimension`\nwhere dw_active_indicator = 'Y';\n\n\nCREATE OR REPLACE VIEW `${ProjectID}.${TargetDatasetNames3}.location_vw`\nAS\nSELECT\ncustomer_uuid AS uuid,\n'CUSTOMER' || '-' || customer_key AS location_uid,\n'CUSTOMER' AS location_type,\ncustomer_number AS location_id,\nname_1 AS location_name,\nname_2 AS location_name2,\nstreet_and_house_number as house_number,\nstreet_and_house_number as street,\ncity,\npostal_code,\ndistrict,\nregion,\ncountry_key as country,\nCAST(NULL AS FLOAT64) as geo_lattitude,\nCAST(NULL AS FLOAT64) as geo_longitude,\nCAST(NULL AS STRING) as time_zone,\ntransportation_zone,\nCAST(NULL AS STRING) as shipping_calendar,\nCAST(NULL AS STRING) as receiving_calendar,\nworking_times as working_hour,\nlanguage_key,\nCAST(NULL AS DATETIME) as valid_from_date,\nCAST(NULL AS DATETIME) as valid_to_date,\nCAST(NULL AS STRING) as active,\nCAST(NULL AS STRING) as company_code,\nCAST(NULL AS STRING) as valuation_area,\ncreated_on as creation_date,\nCAST(NULL AS DATE) as change_date\nFROM `${ProjectID}.${TargetDatasetNames1}.customer_dimension`\nwhere dw_active_indicator = 'Y'\nUNION ALL \nSELECT \nsupplier_uuid AS UUID,\n'SUPPLIER' || '-' || supplier_key AS location_uid,\n'SUPPLIER' AS location_type,\nvendors_account_number AS location_id,\nname_1 AS location_name,\nname_2 AS location_name2,\nstreet_and_house_number as house_number,\nstreet_and_house_number as street,\ncity,\npostal_code,\ndistrict,\nregion,\ncountry_key as country,\nCAST(NULL AS FLOAT64) as geo_lattitude,\nCAST(NULL AS FLOAT64) as geo_longitude,\nCAST(NULL AS STRING) as time_zone,\nCAST(NULL AS STRING) as transportation_zone,\nCAST(NULL AS STRING) as shipping_calendar,\nCAST(NULL AS STRING) as receiving_calendar,\nfactory_calendar as working_hour,\nlanguage_key,\nCAST(NULL AS DATETIME) as valid_from_date,\nCAST(NULL AS DATETIME) as valid_to_date,\nCAST(NULL AS STRING) as active,\nCAST(NULL AS STRING) as company_code,\nCAST(NULL AS STRING) as valuation_area,\ncreated_on as creation_date,\nCAST(NULL AS DATE) as change_date\nFROM `${ProjectID}.${TargetDatasetNames1}.supplier_dimension`\nwhere dw_active_indicator = 'Y'\nUNION ALL \nSELECT \nplant_uuid AS UUID,\n'PLANT' || '-' || plant_key AS location_uid,\n'PLANT' AS location_type,\nplant AS location_id,\nname AS location_name,\nname_2 AS location_name2,\nstreet_house_number as house_number,\nstreet_house_number as street,\ncity,\npo_box,\ncity,\nregion,\ncountry_key as country,\nCAST(NULL AS FLOAT64) as geo_lattitude,\nCAST(NULL AS FLOAT64) as geo_longitude,\nCAST(NULL AS STRING) as time_zone,\nCAST(NULL AS STRING) as transportation_zone,\nCAST(NULL AS STRING) as shipping_calendar,\nCAST(NULL AS STRING) as receiving_calendar,\nfactory_calendar as working_hour,\nlanguage_key,\nCAST(NULL AS DATETIME) as valid_from_date,\nCAST(NULL AS DATETIME) as valid_to_date,\nCAST(NULL AS STRING) as active,\nCAST(NULL AS STRING) as company_code,\nCAST(NULL AS STRING) as valuation_area,\nCAST(NULL AS DATE) as creation_date,\nCAST(NULL AS DATE) as change_date\nFROM `${ProjectID}.${TargetDatasetNames1}.plant_dimension`\nwhere dw_active_indicator = 'Y';\n\n\nCREATE OR REPLACE VIEW `${ProjectID}.${TargetDatasetNames3}.order_vw`\nAS\nSELECT sof.sales_order_uuid as uuid\n,sof.sales_order_key AS order_uid\n,'SALES' as order_category\n,sof.sales_document_type as order_type\n,sof.sales_document as order_id\n,sof.item_number as item_id\n,sof.schedule_line_number as schedule_id\n,'PRODUCT' || '-' || sof.material_key as product_uid\n,'PLANT' || '-' || sof.plant_key as location_uid\n,'CUSTOMER' || '-' || sof.customer_sales_org_key as key_legal_entity_uid\n,'CUSTOMER' || '-' || sof.ship_to_party as receiving_location_uid\n,'PLANT' || '-' || sof.shipping_point as shipping_location_uid\n,CAST(sof.order_quantity AS INT64) as requested_quantity\n,CAST(sof.confirmed_quantity AS INT64) as confirmed_quantity\n,CAST((sof.order_quantity - sof.delivered_quantity) AS INT64) as open_quantity\n,CAST(sof.delivered_quantity AS INT64) as delivery_quantity\n,CAST(sof.delivered_quantity AS INT64) as shipping_quantity\n,CAST(sof.delivered_quantity AS INT64) as received_quantity\n,CAST(NULL AS INT64) as rejected_quantity\n,CAST(NULL AS STRING) AS rejection_code\n,CAST(NULL AS STRING) AS order_uom\n,CAST(sof.net_price_sales_quantity AS FLOAT64) as sales_price\n,CAST(NULL AS STRING) as sales_price_currency\n,CAST(sof.requested_delivery_date AS DATE) AS requested_delivery_date\n,CAST(NULL AS DATE) AS confirmed_delivery_date\n,CAST(sof.actual_goods_movement_date AS DATE) AS actual_delivery_date\n,CAST(NULL AS DATE) AS goodsissue_date_requested\n,CAST(NULL AS DATE) AS goodsissue_date_confirmed\n,CAST(sof.actual_goods_movement_date AS DATE) AS goodsissue_date_actual\n,CAST(NULL AS STRING) as status\n,CAST(NULL AS STRING) as order_block\n,CAST(NULL AS STRING) as preceding_document\n,CAST(NULL AS STRING) as successor_document\n,CAST(NULL AS STRING) as mode_of_transport\n,CAST(NULL AS STRING) as route_id\n,CAST(NULL AS STRING) as asset_id\n,CAST(NULL AS STRING) as active\n,sof.company_code as company_code\n,pd.valuationion_area as valuation_area\n,CAST(sof.created_on AS DATE) as creation_Date\n,CAST(sof.changed_on AS DATE) as change_Date\nFROM `${ProjectID}.${TargetDatasetNames2}.sales_order_fact` sof\n    left join `${ProjectID}.${TargetDatasetNames1}.plant_dimension` pd \non pd.plant_key = sof.plant_key\nand pd.dw_active_indicator = 'Y'\nwhere sof.dw_active_indicator = 'Y'\nUNION ALL \nSELECT pof.purchase_order_uuid as uuid\n,pof.purchase_order_key AS order_uid\n,'PURCHASE' as order_Category\n,pof.purchasing_document_type as order_type\n,pof.purchasing_document_number as order_id\n,pof.item_number as item_id\n,CAST(NULL AS STRING) as schedule_id\n,'PRODUCT' || '-' || pof.material_key as product_uid\n,'PLANT' || '-' || pof.plant_key as location_uid\n,'SUPPLIER' || '-' || pof.supplier_purchase_org_key as key_legal_entity_uid\n,'PLANT' || '-' || pof.plant_key as receiving_location_uid\n,'SUPPLIER' || '-' || pof.supplier_key as shipping_location_uid\n,CAST(pof.order_quantity as INT64) as requested_quantity\n,CAST(pof.order_quantity as INT64) as confirmed_quantity\n,CAST(pof.order_quantity - pof.current_goods_receipt_quantity as INT64) as open_quantity\n,CAST(NULL AS INT64) as delivery_quantity\n,CAST(NULL AS INT64) as shipping_quantity\n,CAST(pof.current_goods_receipt_quantity AS INT64) as received_quantity\n,CAST(NULL AS INT64) as rejected_quantity\n,CAST(NULL AS STRING) AS rejection_code\n,CAST(NULL AS STRING) AS order_uom\n,CAST(NULL AS FLOAT64) as sales_price\n,CAST(NULL AS STRING) as sales_price_currency\n,CAST(pof.purchasing_document_date AS DATE) AS requested_delivery_date\n,CAST(pof.purchasing_document_date AS DATE) AS confirmed_delivery_date\n,CAST(NULL AS DATE) AS actual_delivery_date\n,CAST(NULL AS DATE) AS goodsissue_date_requested\n,CAST(NULL AS DATE) AS goodsissue_date_confirmed\n,CAST(NULL AS DATE) AS goodsissue_date_actual\n,CAST(NULL AS STRING) as status\n,CAST(NULL AS STRING) as order_block\n,CAST(NULL AS STRING) as preceding_document\n,CAST(NULL AS STRING) as successor_document\n,CAST(NULL AS STRING) as mode_of_transport\n,CAST(NULL AS STRING) as route_id\n,CAST(NULL AS STRING) as asset_id\n,CAST(NULL AS STRING) as active\n,pd.company_code as company_code\n,pd.valuationion_area as valuation_area\n,CAST(NULL AS DATE) as creation_Date\n,CAST(NULL AS DATE) as change_Date\nFROM `${ProjectID}.${TargetDatasetNames2}.purchase_order_fact` pof\n    left join `${ProjectID}.${TargetDatasetNames1}.plant_dimension` pd \non pd.plant_key = pof.plant_key\nand pd.dw_active_indicator = 'Y'\nwhere pof.dw_active_indicator = 'Y'\nUNION ALL \nSELECT df.delivery_uuid as uuid\n,df.delivery_key AS order_uid\n,'DELIVERY' as order_category\n,df.delivery_type as order_type\n,df.sales_document as order_id\n,df.item_number as item_id\n,CAST(NULL AS STRING) as schedule_id\n,'PRODUCT' || '-' || df.material_key as product_uid\n,'PLANT' || '-' || df.plant_key as location_uid\n,'CUSTOMER' || '-' || df.sold_to_party as key_legal_entity_uid\n,'CUSTOMER' || '-' || df.customer_key as receiving_location_uid\n,'PLANT' || '-' || df.shipping_point as shipping_location_uid\n,CAST(NULL as INT64) as requested_quantity\n,CAST(NULL as INT64) as confirmed_quantity\n,CAST(df.actual_delivery_quantity as INT64) as open_quantity\n,CAST(NULL AS INT64) as delivery_quantity\n,CAST(NULL AS INT64) as shipping_quantity\n,CAST(NULL AS INT64) as received_quantity\n,CAST(NULL AS INT64) as rejected_quantity\n,CAST(NULL AS STRING) AS rejection_code\n,CAST(NULL AS STRING) AS order_uom\n,CAST(NULL AS FLOAT64) as sales_price\n,CAST(NULL AS STRING) as sales_price_currency\n,CAST(NULL AS DATE) AS requested_delivery_date\n,CAST(NULL AS DATE) AS confirmed_delivery_date\n,CAST(NULL AS DATE) AS actual_delivery_date\n,CAST(NULL AS DATE) AS goodsissue_date_requested\n,CAST(NULL AS DATE) AS goodsissue_date_confirmed\n,CAST(NULL AS DATE) AS goodsissue_date_actual\n,CAST(NULL AS STRING) as status\n,CAST(NULL AS STRING) as order_block\n,CAST(NULL AS STRING) as preceding_document\n,CAST(NULL AS STRING) as successor_document\n,CAST(NULL AS STRING) as mode_of_transport\n,CAST(NULL AS STRING) as route_id\n,CAST(NULL AS STRING) as asset_id\n,CAST(NULL AS STRING) as active\n,pd.company_code as company_code\n,pd.valuationion_area as valuation_area\n,CAST(df.created_on AS DATE) as creation_Date\n,CAST(df.changed_on AS DATE) as change_Date\nFROM `${ProjectID}.${TargetDatasetNames2}.delivery_fact` df\n    left join `${ProjectID}.${TargetDatasetNames1}.plant_dimension` pd \non pd.plant_key = df.plant_key\nand pd.dw_active_indicator = 'Y'\nwhere df.dw_active_indicator = 'Y';\n\n\nCREATE OR REPLACE VIEW `${ProjectID}.${TargetDatasetNames3}.product_vw`\nAS\nSELECT material_uuid as uuid\n      ,'PRODUCT' || '-' || material_key as product_uid\n      ,material_number as product_id\n      ,plant as organization_level\n      ,material_type as product_type\n      ,material_description as product_description\n      ,material_group as product_group\n      ,product_hierarchy\n      ,batch_management_indicator as batch_managed \n      ,procurement_type as procurement_type\n      ,base_unit_of_measure as base_uom \n      ,material_category as product_category\n      ,temperature_conditions_indicator as temperature_condition \n      ,CAST(product_cost AS FLOAT64) as product_cost \n      ,currency_key as product_cost_currency\n      ,CAST(NULL AS STRING) as shelf_life \n      ,CAST(NULL AS STRING) as product_classification\n      ,CAST(NULL AS STRING) as safty_stock\n      ,volume\n      ,gross_weight\n      ,CAST(NULL AS DATE) as valid_from_date\n      ,CAST(NULL AS DATE) as valid_to_date\n      ,client_level_deletion_flag as active\n      ,created_on as creation_date\n      ,last_change as change_date\n      ,CAST(NULL AS NUMERIC) as lead_time\n      ,CAST(NULL AS STRING) as product_hierarchy_name\n      ,CAST(NULL AS STRING) as product_hierarchy_level\n      ,CAST(NULL AS STRING) as product_hierarchy_level_name\n      ,CAST(NULL AS STRING) as product_hierarchy_level_1\n      ,CAST(NULL AS STRING) as product_hierarchy_level_1_name\n      ,CAST(NULL AS STRING) as product_hierarchy_level_2\n      ,CAST(NULL AS STRING) as product_hierarchy_level_2_name\n  FROM `${ProjectID}.${TargetDatasetNames1}.material_dimension`\nWHERE dw_active_indicator = 'Y'",
                        "dialect": "standard",
                        "mode": "batch",
                        "useCache": "false",
                        "location": "US",
                        "rowAsArguments": "false",
                        "serviceAccountType": "filePath",
                        "serviceFilePath": "auto-detect"
                    }
                },
                "outputSchema": [
                    {
                        "name": "etlSchemaBody",
                        "schema": ""
                    }
                ],
                "id": "L2-table-views"
            }
        ],
        "schedule": "0 * * * *",
        "engine": "spark",
        "numOfRecordsPreview": 100,
        "description": "L2 table views",
        "maxConcurrentRuns": 1
    }
}